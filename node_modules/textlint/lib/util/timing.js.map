{"version":3,"sources":["../../src/util/timing.js"],"names":[],"mappings":"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","file":"timing.js","sourcesContent":["/**\n * @fileoverview Tracks performance of individual rules.\n * @author Brandon Mills\n * @copyright 2014 Brandon Mills. All rights reserved.\n */\n\"use strict\";\nimport Logger from \"./logger\";\n\n/* istanbul ignore next */\n/**\n * Align the string to left\n * @param {string} str string to evaluate\n * @param {int} len length of the string\n * @param {string} ch delimiter character\n * @returns {string} modified string\n * @private\n */\nfunction alignLeft(str, len, ch) {\n    return str + new Array(len - str.length + 1).join(ch || \" \");\n}\n\n/* istanbul ignore next */\n/**\n * Align the string to right\n * @param {string} str string to evaluate\n * @param {int} len length of the string\n * @param {string} ch delimiter character\n * @returns {string} modified string\n * @private\n */\nfunction alignRight(str, len, ch) {\n    return new Array(len - str.length + 1).join(ch || \" \") + str;\n}\n\nvar enabled = Boolean(process.env.TIMING);\n\nvar HEADERS = [\"Rule\", \"Time (ms)\", \"Relative\"];\nvar ALIGN = [alignLeft, alignRight, alignRight];\n\n/* istanbul ignore next */\n/**\n * display the data\n * @param {object} data Data object to be displayed\n * @returns {string} modified string\n * @private\n */\nfunction display(data) {\n    var total = 0;\n    var rows = Object.keys(data)\n        .map(function (key) {\n            var time = data[key];\n            total += time;\n            return [key, time];\n        })\n        .sort(function (a, b) {\n            return b[1] - a[1];\n        })\n        .slice(0, 10);\n\n    rows.forEach(function (row) {\n        row.push((row[1] * 100 / total).toFixed(1) + \"%\");\n        row[1] = row[1].toFixed(3);\n    });\n\n    rows.unshift(HEADERS);\n\n    var widths = [];\n    rows.forEach(function (row) {\n        for (var i = 0; i < row.length; i++) {\n            var n = row[i].length;\n            if (!widths[i] || n > widths[i]) {\n                widths[i] = n;\n            }\n        }\n    });\n\n    var table = rows.map(function (row) {\n        return row.map(function (cell, index) {\n            return ALIGN[index](cell, widths[index]);\n        }).join(\" | \");\n    });\n    table.splice(1, 0, widths.map(function (w, index) {\n        if (index !== 0 && index !== widths.length - 1) {\n            w++;\n        }\n\n        return ALIGN[index](\":\", w + 1, \"-\");\n    }).join(\"|\"));\n\n    Logger.log(table.join(\"\\n\"));\n}\n\n/* istanbul ignore next */\nmodule.exports = (function () {\n\n    var data = Object.create(null);\n\n    /**\n     * Time the run\n     * @param {*} key key from the data object\n     * @param {Function} fn function to be called\n     * @returns {Function} function to be executed\n     * @private\n     */\n    function time(key, fn) {\n        if (typeof data[key] === \"undefined\") {\n            data[key] = 0;\n        }\n\n        return function () {\n            var t = process.hrtime();\n            fn.apply(null, Array.prototype.slice.call(arguments));\n            t = process.hrtime(t);\n            data[key] += t[0] * 1e3 + t[1] / 1e6;\n        };\n    }\n\n    if (enabled) {\n        process.on(\"exit\", function () {\n            display(data);\n        });\n    }\n\n    return {\n        time: time,\n        enabled: enabled\n    };\n\n}());\n\n"]}